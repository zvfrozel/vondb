desc: Circle inequality
source: IMO 2002/6
tags: [2019-04, combogeo, maturity, optimization, criticalclaim, meta, neatness, manip, yod]
hardness: 45
url: https://aops.com/community/p118677
author: Vyacheslav Yasinsky (UKR)

---

Let $n \ge 3$ be a positive integer.
Let $C_1$, $C_2$, \dots, $C_n$ be unit circles in the plane,
with centers $O_1$, $O_2$, \dots, $O_n$ respectively.
If no line meets more than two of the circles, prove that
\[ \sum_{1 \le i < j \le n } \frac{1}{O_i O_j}
  \le \frac{(n-1)\pi}{4}. \]

---

For brevity, let $d_{ij}$ be the length of $O_{ij}$
and let $\angle(ijk)$ be shorthand for $\angle O_i O_j O_k$
(or its measure in radians).

First, we eliminate the circles completely
and reduce the problem to angles using the following fact
(which is in part motivated by the mysterious
presence of $\pi$ on right-hand side,
and also brings $d_{ij}\inv$ into the picture).

\begin{lemma*}
  For any indices $i$, $j$, $m$ we have the inequalities
  \[ \angle (imj) \ge
      \max \left( \frac{2}{d_{mi}}, \frac{2}{d_{mj}} \right)
      \quad\text{and}\quad
    \pi - \angle (imj) \ge
    \max \left( \frac{2}{d_{mi}}, \frac{2}{d_{mj}} \right). \]
\end{lemma*}
\begin{proof}
  We first prove the former line.
  Consider the altitude from $O_i$ to $O_m O_j$.
  The altitude must have length at least $2$,
  otherwise its perpendicular bisector passes
  intersects all of $C_i$ , $C_m$, $C_j$.
  Thus
  \[ 2 \le d_{mi} \sin \angle(imj) \le \angle(imj) \]
  proving the first line.
  The second line follows by considering the external
  angle formed by lines $O_m O_i$ and $O_m O_j$
  instead of the internal one.
\end{proof}

Our idea now is for any index $m$
we will make an estimate on
$\sum_{\substack{1 \le i \le n \\ i \neq b}} \frac{1}{d_{bi}}$
for each index $b$.
If the centers formed a convex polygon,
this would be much simpler,
but because we do not have this assumption some more care is needed.

\begin{claim*}
  Suppose $O_a$, $O_b$, $O_c$ are consecutive vertices
  of the convex hull.
  Then
  \[ \frac{n-1}{n-2} \dang(abc) \ge \frac{2}{d_{1b}} + \frac{2}{d_{2b}}
    + \dots + \frac{2}{d_{nb}} \]
  where the term $\frac{2}{d_{bb}}$ does not appear (obviously).
\end{claim*}

\begin{proof}
  WLOG let's suppose $(a,b,c) = (2,1,n)$ and
  that rotating ray $O_2 O_1$ hits $O_3$, $O_4$, \dots, $O_n$
  in that order.
  We have
  \begin{align*}
    \frac{2}{d_{12}} &\le \angle(213) \\
    \frac{2}{d_{13}} &\le \min \left\{ \angle(213), \angle(314) \right\} \\
    \frac{2}{d_{14}} &\le \min \left\{ \angle(314), \angle(415) \right\} \\
    &\vdotswithin=  \\
    \frac{2}{d_{1(n-1)}} &\le
      \min \left\{ \angle((n-2)1(n-1)), \angle((n-1)1n) \right\} \\
    \frac{2}{d_{1n}} &\le \angle\left( (n-1) 1 n \right).
  \end{align*}
  Of the $n-1$ distinct angles appearing on the right-hand side,
  we let $\kappa$ denote the smallest of them.
  We have $\kappa \le \frac{1}{n-2} \angle(21n)$
  by pigeonhole principle.
  Then we pick the minimums on the right-hand side in
  the unique way such that summing gives
  \begin{align*}
    \sum_{i=2}^n \frac{2}{d_{1i}}
    &\ge \left( \angle(213)+\angle(314)+\dots+\angle( (n-1)1n ) \right)
      + \kappa \\
    &\ge \angle(21n) + \frac{1}{n-2} \angle(21n) = \frac{n-1}{n-2} \angle(21n)
  \end{align*}
  as desired.
\end{proof}


Next we show a bound that works for any center,
even if it does not lie on the convex hull $\mathcal H$.
\begin{claim*}
  For any index $b$ we have
  \[ \frac{n-1}{n-2} \pi \ge \frac{2}{d_{1b}} + \frac{2}{d_{2b}}
    + \dots + \frac{2}{d_{nb}} \]
  where the term $\frac{2}{d_{bb}}$ does not appear (obviously).
\end{claim*}
\begin{proof}
  This is the same argument as in the previous proof,
  with the modification that
  because $O_b$ could lie inside the convex hull now,
  our rotation argument should use lines instead of rays
  (in order for the angle to be $\pi$ rather than $2\pi$).
  This is why the first lemma is stated with two cases;
  we need it now.

  Again WLOG $b=1$.
  Consider line $O_{1} O_2$ (rather than just the ray)
  and imagine rotating it counterclockwise through $O_2$;
  suppose that this line passes through $O_3$, $O_4$, \dots, $O_{n}$
  in that order before returning to $O_{2}$ again.
  We let $\dang (i1j) \in \{ \angle (i1j), \pi-\angle(i1j) \} \in [0, \pi)$ %chktex 9
  be the counterclockwise rotations obtained in this way,
  so that
  \[ \dang(21n) = \dang(213) + \dang(314) +
    + \dots + \dang((n-1)1n). \]
  (This is not ``directed angles'', but related.)

  Then we get bounds
  \begin{align*}
    \frac{2}{d_{12}} &\le \dang(213) \\
    \frac{2}{d_{13}} &\le \min \left\{ \dang(213), \dang(314) \right\} \\
    &\vdotswithin=  \\
    \frac{2}{d_{1(n-1)}} &\le
      \min \left\{ \dang((n-2)1(n-1)), \dang((n-1)1n) \right\} \\
    \frac{2}{d_{1n}} &\le \dang\left\{ (n-1) 1 n \right\}
  \end{align*}
  as in the last proof, and so as before we get
  \[ \sum_{i=1}^n \frac{2}{d_{1i}} \le \frac{n-1}{n-2} \dang(21n) \]
  which is certainly less than $\frac{n-1}{n-2} \pi$.
\end{proof}

Now suppose there were $r$ vertices in the convex hull.
If we sum the first claim across all $b$ on the hull,
and the second across all $b$ not on the hull (inside it),
we get
\begin{align*}
  \sum_{1 \le i<j \le n} \frac{2}{d_{ij}}
  &= \half \sum_b \sum_{i \neq b} \frac{2}{d_{bi}} \\
  &\le \half \cdot \frac{n-1}{n-2} \left( (r-2)\pi + (n-r)\pi  \right) \\
  &= \frac{(n-1)\pi}{4}
\end{align*}
as needed (with $(r-2)\pi$ being the sum of angles in the hull).
