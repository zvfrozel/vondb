author: Ankan Bhattacharya (USA)
desc: Prime ring
hardness: 40
source: IMO 2022/3
url: https://aops.com/community/p25635143
tags: [2022-12, magic, nice, induct, size, manip, zayin]

---

Let $k$ be a positive integer and let $S$ be a finite set of odd prime numbers.
Prove that there is at most one way (up to rotation and reflection)
to place the elements of $S$ around the circle such that the product
of any two neighbors is of the form $x^2+x+k$ for some positive integer $x$.

---

We replace ``positive integer $x$'' with ``nonnegative integer $x$'',
and say numbers of the form $x^2+x+k$ are \emph{good}.
We could also replace ``nonnegative integer $x$'' with ``integer $x$''
owing to the obvious map $x \mapsto 1-x$.

\begin{claim*}
  If $p$ is an odd prime, there are at most two odd primes $q$ and $r$
  less than $p$ for which $pq = x^2+x+k$ and $pr = y^2+y+k$ are good.

  Moreover, if the above occurs and $x,y \ge 0$,
  then $x+y+1=p$ and $xy \equiv k \pmod p$.
\end{claim*}
\begin{proof}
  The equation $T^2+T+k \equiv 0 \pmod{p}$ has at most two solutions
  modulo $p$, i.e.\ at most two solutions in the interval $[0,p-1]$.
  Because $0 \le x,y < p$ from $p > \max(q,r)$ and $k > 0$,
  the first half follows.

  For the second half,
  Vieta also gives $x+y \equiv -1 \pmod p$ and $xy \equiv k \pmod p$,
  and we know $0 < x+y < 2p$.
\end{proof}

\begin{claim*}
  If two such primes do exist as above, then $qr$ is also good (!).
\end{claim*}
\begin{proof}
  Let $pq = x^2+x+k$ and $pr = y^2+y+k$ for $x,y \ge 0$ as before.
  Fix $\alpha \in \CC$ such that $\alpha^2 + \alpha + k = 0$;
  then for any $n \in \ZZ$, we have
  \[ n^2 + n + k = \opname{Norm}(n-\alpha). \]
  Hence
  \[
    pq \cdot pr = \opname{Norm}\Big((x-\alpha)(y-\alpha)\Big)
    = \opname{Norm}\Big( (xy-k) - (x+y+1)\alpha\Big)
  \]
  But $\opname{Norm}(p) = p^2$,
  so combining with the second half of the previous claim gives
  \[ qr = \opname{Norm}(\frac1p(xy-k)-\alpha) \] as needed.
\end{proof}

These two claims imply the claim directly by induction on $|S|$,
since one can now delete the largest element of $S$.

\begin{remark*}
  To show that the condition is not vacuous,
  the author gave a ring of $385$ primes for $k=41$;
  see \url{https://aops.com/community/p26068963}.
\end{remark*}
